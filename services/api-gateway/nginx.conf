events {
    worker_connections 1024;
}

http {
    # Upstreams para los servicios de backend
    upstream auth_service {
        server auth-service:3001;
    }
    upstream config_service {
        server config-service:3002;
    }
    upstream appointment_service {
        server appointment-service:3003;
    }

    # Upstreams para los servicios de frontend
    upstream auth_frontend {
        server auth-frontend:80;
    }
    upstream lobby_frontend {
        server lobby-frontend:80;
    }
    upstream config_frontend {
        server config-frontend:80;
    }

    server {
        listen 80;
        server_name localhost;

        # ============================================
        # API Endpoints
        # ============================================

        location /api/auth/ {
            proxy_pass http://auth_service/api/auth/;
        }

        location /api/config/ {
            proxy_pass http://config_service/api/config/;
        }

        location /api/appointments/ {
            proxy_pass http://appointment_service/api/appointments/;
        }

        # ============================================
        # Frontend Endpoints
        # ============================================

        location /auth/ {
            proxy_pass http://auth_frontend/;
        }

        location /config/ {
            proxy_pass http://config_frontend/;
        }

        location / {
            proxy_pass http://lobby_frontend/;
        }
    }
}